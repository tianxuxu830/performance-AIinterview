
# 产品设计文档 (PRD) - 智能绩效面谈模块 (完整版)

| 文档版本 | 修改日期 | 修改人 | 修改内容 |
| :--- | :--- | :--- | :--- |
| v1.0 | 2025-05-20 | AI Architect | 初始化面谈模块设计 |
| v2.0 | 2025-05-21 | AI Architect | 根据现有代码实现更新：新增直接反馈模式、模版配置器、员工仪表盘及360冲突分析 |
| v2.1 | 2025-05-22 | AI Architect | 优化面谈发起流程：关联考核任务前置、面谈结果确认功能配置化（开关/签名方式） |
| v2.2 | 2025-05-23 | AI Architect | 界面布局优化：发起弹窗字段并排调整，确认开关位置优化 |

---

## 1. 项目背景与目标

### 1.1 项目背景
- **业务背景**：绩效管理闭环中，“面谈”是连接“评估结果”与“绩效改进”的关键环节。
- **现状问题**：
    1.  **流程割裂**：打分在系统，面谈在线下，数据无沉淀。
    2.  **形式单一**：仅支持正式会议，缺乏灵活的“直接反馈”机制（如试用期、日常辅导）。
    3.  **信息不对称**：面谈时管理者无法快速获取多维度（自评、互评、下属评价）的差异数据。
    4.  **配置僵化**：无法灵活定义面谈记录表单的结构（表格 vs 表单）。

### 1.2 核心目标与成功标准
- **业务目标**：打造“发起-排期-执行-归档”的全流程闭环。
- **功能目标**：
    - 支持 **同步（会议）** 与 **异步（直接反馈）** 两种沟通模式。
    - 提供 **AI 辅助**（话术建议、内容润色、自动填单）。
    - 提供 **数据洞察**（历史趋势、360评分差异分析）。
- **成功标准**：
    - 面谈记录线上化率 100%。
    - 管理者在面谈准备阶段耗时减少 50%（通过智能大纲与数据看板）。

---

## 2. 用户与使用场景定义

### 2.1 用户角色
| 角色 | 权限边界 | 核心诉求 |
| :--- | :--- | :--- |
| **HR 管理员** | 全局配置 | 配置面谈模板、监控全公司面谈进度、强制归档、数据导出。 |
| **管理者 (Manager)** | 团队级 | 发起面谈、选择面谈方式（直接/预约）、查看员工画像及冲突分析、填写记录。 |
| **员工 (Employee)** | 个人级 | 接收面谈邀请、查看面谈结果、确认反馈内容、管理个人日程。 |

### 2.2 使用场景说明

#### 场景 A：周期性绩效面谈 (Standard)
- **触发**：季度/年度考核分出炉。
- **流程**：管理者批量发起 -> 选择“预约会议” -> 双方入会 -> 填写记录 -> 双方确认。
- **特点**：强仪式感，依赖视频/线下会议。

#### 场景 B：日常辅导/直接反馈 (Direct Feedback)
- **触发**：项目结束复盘、试用期评估、轻量级沟通。
- **流程**：管理者发起 -> 选择“直接反馈” -> 填写表单并提交 -> 员工在线确认。
- **特点**：高效、异步，无需预约时间槽。

#### 场景 C：面谈配置与管理 (Configuration)
- **触发**：HR 准备新的考核周期。
- **流程**：HR 拖拽配置面谈模板（定义是表格还是表单布局） -> 导入历史题目 -> 发布模板。

---

## 3. 需求范围与优先级

| 模块 | 功能点 | 优先级 | 实现状态 |
| :--- | :--- | :--- | :--- |
| **面谈工作台** | 列表筛选、批量催办、新建任务 | P0 | ✅ 已实现 |
| **任务发起** | 关联周期/任务前置、结果确认配置、角色选择 | P0 | ✅ 已实现 |
| **执行终端** | 分屏视图、AI润色、AI一键填充 | P0 | ✅ 已实现 |
| **数据洞察** | 历史趋势图、**360°评分差异分析** | P1 | ✅ 已实现 |
| **排期管理** | 预约弹窗、腾讯会议集成模拟 | P1 | ✅ 已实现 |
| **模板配置** | 拖拽排序、表单/表格视图切换、文件导入 | P1 | ✅ 已实现 |
| **员工端** | 仪表盘、日历视图、待办处理 | P2 | ✅ 已实现 |

---

## 4. 功能需求详细说明

### 4.1 面谈工作台 (InterviewList)
- **多维度视图**：支持按“待排期”、“待开始”、“待反馈”、“已完成”快速筛选。
- **侧边栏详情**：点击列表右侧图标，侧滑展示该员工的历史面谈记录 (`MOCK_HISTORY_RECORDS`)，便于追溯。
- **批量操作**：支持多选任务后进行“批量催办”。

### 4.2 发起面谈 (NewInterviewModal)
- **核心字段逻辑**：
    - **关联考核任务 (Assessment Task)**：**[P0前置条件]** 用户必须首先选择考核任务（如“2025 Q4 绩效考核”）。
    - **面谈对象 (Target Employee)**：**[联动过滤]** 面谈对象列表将自动根据所选的考核任务范围进行过滤，确保数据上下文一致。
    - **布局优化**：**面谈主题**与**评估模板**调整为同行展示；**面谈官**与**截止时间**同行展示，提高屏效。
- **流程配置 - 结果确认**：
    - **开关控制**：提供“面谈结果需员工确认”开关，开关控件紧跟在文字标题之后。
    - **确认方式 (Signature Type)**：当开关开启时，提供三种确认方式：
        1.  **仅确认 (Confirmation Only)**：员工点击“确认”按钮即可（适用于日常轻量沟通）。
        2.  **手写签 (Handwritten)**：需员工在移动端/PC端进行手写签名（适用于正式绩效归档）。
        3.  **电子签 (Electronic Signature)**：需对接 CA 认证的电子签章流程（适用于法律效力要求高的场景）。

### 4.3 面谈执行终端 (InterviewForm)
本模块采用 **左分析-右记录** 的分屏设计，支持拖拽调整宽度。

#### 左侧：数据洞察面板 (Insight Panel)
1.  **综合评分卡**：展示当前关联周期的分数、等级、环比变化。
2.  **重点关注卡片**：
    - **争议项**：高亮自评与他评分差过大的指标。
    - **业绩亮点**：展示高分指标。
3.  **360° 冲突分析 (Conflict Analysis)**：
    - 点击争议项，弹出模态框。
    - 矩阵式展示：自评、上级、虚线主管、同事、下属在同一指标上的评分与评语对比。
4.  **历史趋势**：折线图展示近 4 个周期的绩效走势。

#### 右侧：智能记录表单 (Smart Form)
1.  **动态渲染**：根据 `templateId` 渲染表单（支持文本域、评分、附件上传）。
2.  **AI 辅助能力**：
    - **AI 润色**：优化管理者输入的评语，使其更专业、客观。
    - **AI 一键生成**：基于左侧绩效数据，自动生成面谈记录初稿。
3.  **模式适配**：
    - 若为 **直接反馈** 模式，按钮显示“提交给员工确认”。
    - 若为 **预约会议** 模式，顶部显示会议状态及“进入会议”入口。

### 4.4 模板配置中心 (TemplateConfig)
- **可视化编辑器**：所见即所得 (WYSIWYG)。
- **布局灵活**：支持 Section（模块）粒度配置。
    - **表单视图**：支持 1列/2列/3列 布局。
    - **表格视图**：适用于 KPI 逐项盘点场景。
- **字段库**：支持从右侧字段库拖拽添加标准字段。
- **智能导入**：支持上传 Word/PDF，AI 识别并自动生成模板结构。

### 4.5 员工端仪表盘 (EmployeeDashboard)
- **日历视图**：可视化展示当月已安排的面谈、待办事项。
- **待办列表**：聚合“待确认绩效”、“待参加面谈”等任务。
- **操作闭环**：支持直接在待办卡片上点击“进入会议”或“填写反馈”。

---

## 5. 数据与状态设计

### 5.1 核心实体：InterviewSession
```typescript
interface InterviewSession {
  id: string;
  employeeId: string;
  managerName: string;
  period: string;           // 面谈主题
  assessmentCycle?: string; // 关键关联：关联的绩效周期 (e.g., '2025 Q4')
  status: Status;           // NotStarted, InProgress, PendingConfirmation, Completed
  method: 'direct' | 'appointment'; // 核心模式区分
  templateId: string;
  schedulingStatus?: 'pending' | 'scheduled'; // 排期子状态
  date?: string;            // 预约时间 YYYY-MM-DD HH:mm
  deadline?: string;        // 截止时间 (用于待排期/直接反馈)
  content?: Record<string, any>; // 填写的表单数据
  // 新增确认流程配置
  requireConfirmation?: boolean;
  signatureType?: 'confirmation' | 'handwritten' | 'electronic';
}
```

### 5.2 状态流转规则
1.  **新建** -> `NotStarted` (schedulingStatus: `pending`)。
2.  **排期/发起直接反馈** -> `NotStarted` (schedulingStatus: `scheduled`) 或 `InProgress` (若为直接反馈)。
3.  **面谈/填写中** -> `InProgress`。
4.  **提交反馈** -> `PendingConfirmation` (等待员工侧确认)。
5.  **员工确认** -> `Completed` (归档)。

---

## 6. 非功能需求

- **响应式布局**：面谈执行页需适配不同分辨率屏幕，左侧面板宽度可拖拽调节。
- **交互反馈**：所有表单操作需有即时保存或提交反馈（Toast 提示）。
- **样式规范**：严格遵循 Tailwind CSS 设计规范，使用 `primary` (Teal/Blue) 主色调，保持界面清爽。

---

## 7. 附录：技术组件映射

| 功能模块 | 对应组件文件 |
| :--- | :--- |
| 面谈列表 | `components/InterviewList.tsx` |
| 执行表单/分析 | `components/InterviewForm.tsx` |
| 预约排期 | `components/InterviewScheduler.tsx` |
| 模板配置 | `components/TemplateModal.tsx` |
| 员工仪表盘 | `components/EmployeeDashboard.tsx` |
| 发起弹窗(含配置) | `components/NewInterviewModal.tsx` |
